import{j as s,r as u}from"./index-fdb54680.js";import{u as _}from"./SurveyHook-b77241ea.js";import{S as g}from"./SuccessAlertModal-5fd775de.js";import{B as f}from"./ButtonLoading-5c14b6da.js";const S=({question:e,index:o,answers:r,setAnswers:i,isPreview:t})=>{const a=c=>{console.log("answer: ",c),i(r.map((d,p)=>d.q_id===e.question_id?{...d,selected_option:c}:d))};return s.jsx(s.Fragment,{children:s.jsxs("div",{className:"column",children:[s.jsxs("h4",{children:[o+1,". ",e.question]}),s.jsxs("div",{children:[s.jsx("input",{type:"radio",name:e.question,disabled:t,value:e.option_1,onChange:()=>a(e.option_1??""),required:!0})," ",e.option_1]}),s.jsxs("div",{children:[s.jsx("input",{type:"radio",name:e.question,disabled:t,value:e.option_2,onChange:()=>a(e.option_2??""),required:!0})," ",e.option_2]}),s.jsxs("div",{children:[s.jsx("input",{type:"radio",name:e.question,disabled:t,value:e.option_3,onChange:()=>a(e.option_3??""),required:!0})," ",e.option_3]})]})})},b=({survey:e,isPreview:o=!1,surveyKey:r})=>{var m,h,x;const[i,t]=u.useState([]),{submitAnswers:a}=_(),[c,d]=u.useState(!1),p=async n=>{if(n.preventDefault(),o||!r)return;console.log("Answers: ",i),await a(i,r)?d(!0):alert("Vastauksien lähettäminen epäonnistui!")};return u.useEffect(()=>{var l;if(o)return;const n=(l=e.questions)==null?void 0:l.map(j=>({q_id:j.question_id}));console.log("s: ",n),t(n)},[e]),s.jsxs("div",{className:"color3 rounded",children:[s.jsx(g,{show:c,message:"Kysely on lähetetty",navRoute:`/survey/${r}/results`}),s.jsxs("div",{style:{borderRadius:"0.5rem 0.5rem 0 0"},className:"color1 padding1",children:[s.jsx("h2",{children:((m=e.survey_header)==null?void 0:m.survey_title)??"Ei nimeä"}),s.jsx("p",{style:{whiteSpace:"pre-line"},children:((h=e.survey_header)==null?void 0:h.description)??"Ei kuvausta"})]}),s.jsx("h4",{className:"padding1",children:`Kysymyksiä (${(x=e.questions)==null?void 0:x.length})`}),s.jsxs("form",{onSubmit:p,style:{gap:"2rem"},className:"padding1",children:[e.questions!==void 0&&s.jsx(s.Fragment,{children:e.questions.map((n,l)=>s.jsx(S,{question:n,index:l,answers:i,setAnswers:t,isPreview:o},n.question_id))}),s.jsx("div",{style:{alignSelf:"center"},children:s.jsx(f,{text:"Lähetä vastaukset"})})]})]})};export{b as A};
