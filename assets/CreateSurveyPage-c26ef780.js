import{r as i,j as e,u as O}from"./index-f8701890.js";import{u as y,c as p}from"./ThemeProvider-55fb9194.js";import{C as V}from"./Nav-3b530566.js";import{f as b}from"./divWithClassName-62f37436.js";import{d as Q}from"./index.esm-b0ce52dd.js";import{A as J,a as G,b as P}from"./DoFetch-1372b22f.js";import{u as X}from"./SurveyHook-ad75b994.js";import{S as Y}from"./SurveyPreview-cab6c529.js";import{B as Z}from"./ButtonLoading-2ee21d0d.js";import{T as ee,a as C}from"./Tabs-bf1bd8b5.js";import{S as se}from"./SuccessAlertModal-cd1d48ba.js";import{F as u,u as ae,a as te,C as re}from"./FormFieldError-15b49254.js";import"./Fade-c44d3d3b.js";import"./Button-a49cbd04.js";import"./iconBase-db4c4a41.js";import"./AnswerSurveyForm-6c544a1f.js";const oe="_container_1us8z_1",ne="_dot_1us8z_7",ie="_selectWeight_1us8z_23",le="_previewTop_1us8z_33",de="_form_1us8z_49",ue="_optionInput_1us8z_57",ce="_createsurveybuttons_1us8z_71",me="_overlay_1us8z_83",ye="_input_1us8z_109",pe="_dates_1us8z_125",ve="_questionCard_1us8z_137",he="_tabsBar_1us8z_153",n={container:oe,dot:ne,selectWeight:ie,previewTop:le,form:de,optionInput:ue,createsurveybuttons:ce,overlay:me,input:ye,dates:pe,questionCard:ve,tabsBar:he},k=i.forwardRef(({className:s,bsPrefix:a,as:t="div",...r},o)=>(a=y(a,"card-body"),e.jsx(t,{ref:o,className:p(s,a),...r})));k.displayName="CardBody";const K=k,F=i.forwardRef(({className:s,bsPrefix:a,as:t="div",...r},o)=>(a=y(a,"card-footer"),e.jsx(t,{ref:o,className:p(s,a),...r})));F.displayName="CardFooter";const xe=F,L=i.forwardRef(({bsPrefix:s,className:a,as:t="div",...r},o)=>{const d=y(s,"card-header"),m=i.useMemo(()=>({cardHeaderBsPrefix:d}),[d]);return e.jsx(V.Provider,{value:m,children:e.jsx(t,{ref:o,...r,className:p(a,d)})})});L.displayName="CardHeader";const je=L,R=i.forwardRef(({bsPrefix:s,className:a,variant:t,as:r="img",...o},d)=>{const m=y(s,"card-img");return e.jsx(r,{ref:d,className:p(t?`${m}-${t}`:m,a),...o})});R.displayName="CardImg";const _e=R,T=i.forwardRef(({className:s,bsPrefix:a,as:t="div",...r},o)=>(a=y(a,"card-img-overlay"),e.jsx(t,{ref:o,className:p(s,a),...r})));T.displayName="CardImgOverlay";const Ne=T,H=i.forwardRef(({className:s,bsPrefix:a,as:t="a",...r},o)=>(a=y(a,"card-link"),e.jsx(t,{ref:o,className:p(s,a),...r})));H.displayName="CardLink";const fe=H,ge=b("h6"),A=i.forwardRef(({className:s,bsPrefix:a,as:t=ge,...r},o)=>(a=y(a,"card-subtitle"),e.jsx(t,{ref:o,className:p(s,a),...r})));A.displayName="CardSubtitle";const Ce=A,E=i.forwardRef(({className:s,bsPrefix:a,as:t="p",...r},o)=>(a=y(a,"card-text"),e.jsx(t,{ref:o,className:p(s,a),...r})));E.displayName="CardText";const qe=E,Se=b("h5"),z=i.forwardRef(({className:s,bsPrefix:a,as:t=Se,...r},o)=>(a=y(a,"card-title"),e.jsx(t,{ref:o,className:p(s,a),...r})));z.displayName="CardTitle";const $e=z,D=i.forwardRef(({bsPrefix:s,className:a,bg:t,text:r,border:o,body:d=!1,children:m,as:l="div",...v},h)=>{const x=y(s,"card");return e.jsx(l,{ref:h,...v,className:p(a,x,t&&`bg-${t}`,r&&`text-${r}`,o&&`border-${o}`),children:d?e.jsx(K,{children:m}):m})});D.displayName="Card";const f=Object.assign(D,{Img:_e,Title:$e,Subtitle:Ce,Body:K,Link:fe,Text:qe,Header:je,Footer:xe,ImgOverlay:Ne}),we=({index:s,register:a,remove:t})=>e.jsxs(f,{children:[e.jsxs(f.Header,{as:"h4",children:["Kysymys ",s+1]}),e.jsxs(f.Body,{children:[e.jsx("textarea",{placeholder:"Kysymys",className:n.input,...a(`questions.${s}.question`,{required:{value:!0,message:"Kysymys vaaditaan"}})}),e.jsxs("div",{className:"column",style:{gap:"0.5rem"},children:[e.jsxs("div",{className:"center-align",children:[e.jsx("span",{className:n.dot}),e.jsx("input",{className:`${n.optionInput} line`,type:"text",placeholder:"Vastaus 1",...a(`questions.${s}.option_1`,{required:{value:!0,message:"1. vastausvaihtoehto vaaditaan"}})}),e.jsx("div",{children:"+1"})]}),e.jsxs("div",{className:"center-align",children:[e.jsx("span",{className:n.dot}),e.jsx("input",{className:`${n.optionInput} line`,type:"text",placeholder:"Vastaus 2",...a(`questions.${s}.option_2`,{required:{value:!0,message:"2. vastausvaihtoehto vaaditaan"}})}),e.jsx("div",{children:"+0,5"})]}),e.jsxs("div",{className:"center-align",children:[e.jsx("span",{className:n.dot}),e.jsx("input",{className:`${n.optionInput} line`,type:"text",placeholder:"Vastaus 3",...a(`questions.${s}.option_3`,{required:{value:!0,message:"3. vastausvaihtoehto vaaditaan"}})}),e.jsx("div",{children:"0"})]})]})]}),e.jsx(f.Footer,{children:e.jsx("button",{onClick:()=>t(s),className:"delete",children:e.jsx(Q,{})})})]});var g=(s=>(s.PUBLISHED="published",s.UNPUBLISHED="unpublished",s))(g||{});const Ie=({errors:s,questions:a})=>{var t,r,o,d;return e.jsxs(e.Fragment,{children:[e.jsx(u,{error:(t=s.survey_header)==null?void 0:t.survey_title}),e.jsx(u,{error:(r=s.survey_header)==null?void 0:r.start_time}),e.jsx(u,{error:(o=s.survey_header)==null?void 0:o.end_time}),e.jsx(u,{error:(d=s.survey_header)==null?void 0:d.description}),s.questions&&a.map((m,l)=>{var v,h,x,j;return e.jsxs(e.Fragment,{children:[e.jsxs("p",{className:"error",children:["Kysymys ",l+1]}),e.jsx(u,{error:s.questions&&((v=s.questions[l])==null?void 0:v.question)}),e.jsx(u,{error:s.questions&&((h=s.questions[l])==null?void 0:h.option_1)}),e.jsx(u,{error:s.questions&&((x=s.questions[l])==null?void 0:x.option_2)}),e.jsx(u,{error:s.questions&&((j=s.questions[l])==null?void 0:j.option_3)})]})})]})},B={question:"",option_1:J,option_2:G,option_3:P},Oe=()=>{var S,$,w,I;const{surveyid:s}=O(),[a,t]=i.useState(!1),[r,o]=i.useState(""),{createSurvey:d,getSurveyById:m}=X(),{register:l,control:v,handleSubmit:h,reset:x,getValues:j,formState:{errors:_}}=ae({defaultValues:{survey_header:{survey_status:g.UNPUBLISHED,start_time:new Date().toISOString().slice(0,10)},questions:[B]}}),{fields:q,append:U,remove:W}=te({control:v,name:"questions"}),M=async c=>{c.survey_header.survey_status=c.survey_header.survey_status===!0?g.PUBLISHED:g.UNPUBLISHED,console.log("data: ",c);const N=await d(c);N&&(o(N),t(!0))};return i.useEffect(()=>{console.log("surveyid: ",s),s&&(async()=>{const c=await m(s);c&&x(c)})()},[]),e.jsxs("main",{className:n.container,children:[e.jsx(se,{show:a,message:r,navRoute:"/admin/surveys"}),e.jsx("form",{onSubmit:h(M),className:`${n.form} color3`,children:e.jsxs(ee,{className:n.tabsBar,children:[e.jsx(C,{eventKey:"survey",title:"Kysely",children:e.jsxs("div",{className:"column",style:{maxWidth:"60ch",gap:"1rem"},children:[e.jsxs("label",{className:"createsurveything",children:["Kyselyn nimi",e.jsx("input",{maxLength:40,className:n.input,type:"text",placeholder:"Kyselyn nimi",...l("survey_header.survey_title",{required:{value:!0,message:"Kyselyn nimi vaaditaan"}})}),e.jsx(u,{error:(S=_.survey_header)==null?void 0:S.survey_title})]}),e.jsxs("div",{className:n.dates,children:[e.jsxs("label",{className:"createsurveything",children:["Alkaa",e.jsx("input",{type:"date",placeholder:"Alkaa",className:n.input,...l("survey_header.start_time",{required:{value:!0,message:"Alkamispäivä vaaditaan"}})}),e.jsx(u,{error:($=_.survey_header)==null?void 0:$.start_time})]}),e.jsxs("label",{className:"createsurveything",children:["Päättyy",e.jsx("input",{type:"date",placeholder:"Päättyy",className:n.input,...l("survey_header.end_time",{required:{value:!0,message:"Päättymispäivä vaaditaan"}})}),e.jsx(u,{error:(w=_.survey_header)==null?void 0:w.end_time})]})]}),e.jsxs("label",{className:"createsurveything",children:["Kuvaus",e.jsx("textarea",{placeholder:"Kuvaus",...l("survey_header.description",{required:{value:!0,message:"Kuvaus vaaditaan"}})}),e.jsx(u,{error:(I=_.survey_header)==null?void 0:I.description})]})]})}),e.jsx(C,{eventKey:"questions",title:"Kysymykset",id:"column",children:e.jsxs("div",{className:"column",children:[e.jsx("h3",{children:`Kysymyksiä (${q.length})`}),e.jsx("div",{className:"column",style:{gap:"1rem"},children:q.map((c,N)=>e.jsx(e.Fragment,{children:e.jsx(we,{index:N,register:l,control:v,remove:W},c.id)}))}),e.jsx("button",{type:"button",className:"colored",onClick:()=>U(B),children:"Lisää kysymys"})]})}),e.jsx(C,{eventKey:"create",title:"Luo kysely",children:e.jsxs("div",{className:"column color3 padding1",children:[e.jsxs("label",{className:"flex-row center-align",children:[e.jsx(re,{name:"survey_header.survey_status",control:v,rules:{required:!1},render:({field:c})=>e.jsx("input",{style:{height:"1rem",width:"1rem"},type:"checkbox",...c})}),"Jaa kysely isännöitsijöille"]}),e.jsxs("div",{className:"flex-row",children:[e.jsx(Y,{survey:j()}),e.jsx(Z,{text:"Luo kysely"})]}),e.jsx(Ie,{errors:_,questions:j().questions})]})})]})})]})};export{Oe as default};
