import{r as u,j as e}from"./index-fdb54680.js";import{u as w,F as t}from"./FormFieldError-c2d8c63e.js";import{P as E,C as N}from"./DoFetch-44b224c4.js";import{u as M}from"./UserHook-96b5e8ec.js";import{B as F}from"./ButtonLoading-5c14b6da.js";import{S as q}from"./SuccessAlertModal-5fd775de.js";const R=({user:r,isAdmin:c=!1})=>{var l,d;const{modifyUser:x,deleteUser:j,modifyUserByAdmin:p}=M(),[a,i]=u.useState(!1),[f,y]=u.useState(!1),{register:o,reset:h,handleSubmit:S,setError:b,formState:{errors:s}}=w({defaultValues:r}),k=async n=>{console.log("modify user data:",n);const m=c?await p(n):await x(n);if(m instanceof N){const g=m.status===409?"Sähköposti on jo käytössä":"Palvelinvirhe";b("root.serverError",{message:g});return}i(!1),y(!0)},v=async()=>{r!=null&&r.user_id&&await j(r.user_id)};return e.jsxs(e.Fragment,{children:[e.jsx(q,{show:f,message:"Käyttäjätiedot muokattu"}),e.jsxs("form",{className:"color3 column",style:{margin:"auto"},onSubmit:S(k),children:[e.jsxs("label",{children:["Nimi",e.jsx("input",{type:"text",className:"line",...o("full_name",{required:"Nimi vaaditaan",disabled:!a})}),e.jsx(t,{error:s.full_name})]}),e.jsxs("label",{children:["Sähköposti",e.jsx("input",{required:!0,type:"email",className:"line",...o("email",{required:"Sähköposti vaaditaan",disabled:!a})}),e.jsx(t,{error:s.email})]}),e.jsxs("label",{children:["Yritys",e.jsx("input",{className:"line",...o("company",{required:"Yritys vaaditaan",disabled:!a})}),e.jsx(t,{error:s.company})]}),e.jsxs("label",{children:["Salasana",e.jsx("input",{required:!0,type:"password",className:"line",...o("password",{required:"Salasana vaaditaan",disabled:!a,pattern:{value:E,message:"Salasanan tulee olla vähintään 8 merkkiä pitkä ja sisältää vähintään yhden numeron"}})}),e.jsx(t,{error:s.password})]}),((l=s.root)==null?void 0:l.serverError)&&e.jsx(t,{error:(d=s.root)==null?void 0:d.serverError}),e.jsxs("div",{className:"flex-row",children:[a?e.jsxs(e.Fragment,{children:[e.jsx(F,{text:"Tallenna"}),e.jsx("button",{type:"button",onClick:()=>{i(!1),h()},children:"Poistu"})]}):e.jsx("button",{onClick:()=>i(!0),children:"Muokkaa"}),e.jsx("button",{type:"button",className:"delete",style:{marginLeft:"auto"},onClick:v,children:"Poista käyttäjä"})]})]})]})};export{R as M};
